<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate an objective function for BioCro model validation — objective_function • BioCroValidation</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate an objective function for BioCro model validation — objective_function"><meta name="description" content='Given a base model definition, drivers to run the model, observed values of
  model outputs, and the names of model arguments to vary,
  objective_function creates an objective function that can be passed to
  a minimization algorithm in order to find optimal parameter values that
  produce the best agreement between the model and the observed data.
The objective function itself is based on a weighted least-squares error
  metric, with optional user-defined penalty terms, and an optional
  regularization penalty term.
It is possible to define a multi-year or multi-location objective function by
  pairing particular sets of drivers with corresponding sets of observed model
  outputs.
It is also possible to include "dependent" model arguments, whose values are
  determined from the "independent" model arguments that are varied during the
  parameterization procedure.
For a detailed example of using objective_function, see the
  "Parameterizing Soybean-BioCro" vignette/article.'><meta property="og:description" content='Given a base model definition, drivers to run the model, observed values of
  model outputs, and the names of model arguments to vary,
  objective_function creates an objective function that can be passed to
  a minimization algorithm in order to find optimal parameter values that
  produce the best agreement between the model and the observed data.
The objective function itself is based on a weighted least-squares error
  metric, with optional user-defined penalty terms, and an optional
  regularization penalty term.
It is possible to define a multi-year or multi-location objective function by
  pairing particular sets of drivers with corresponding sets of observed model
  outputs.
It is also possible to include "dependent" model arguments, whose values are
  determined from the "independent" model arguments that are varied during the
  parameterization procedure.
For a detailed example of using objective_function, see the
  "Parameterizing Soybean-BioCro" vignette/article.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BioCroValidation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/BioCroValidation.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/parameterizing_soybean_biocro.html">Parameterizing Soybean-BioCro</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BioCro/BioCroValidation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate an objective function for BioCro model validation</h1>

      <div class="d-none name"><code>objective_function.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a base model definition, drivers to run the model, observed values of
  model outputs, and the names of model arguments to vary,
  <code>objective_function</code> creates an objective function that can be passed to
  a minimization algorithm in order to find optimal parameter values that
  produce the best agreement between the model and the observed data.</p>
<p>The objective function itself is based on a weighted least-squares error
  metric, with optional user-defined penalty terms, and an optional
  regularization penalty term.</p>
<p>It is possible to define a multi-year or multi-location objective function by
  pairing particular sets of drivers with corresponding sets of observed model
  outputs.</p>
<p>It is also possible to include "dependent" model arguments, whose values are
  determined from the "independent" model arguments that are varied during the
  parameterization procedure.</p>
<p>For a detailed example of using <code>objective_function</code>, see the
  "Parameterizing Soybean-BioCro" vignette/article.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">objective_function</span><span class="op">(</span></span>
<span>    <span class="va">base_model_definition</span>,</span>
<span>    <span class="va">data_driver_pairs</span>,</span>
<span>    <span class="va">independent_args</span>,</span>
<span>    <span class="va">quantity_weights</span>,</span>
<span>    data_definitions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    normalization_method <span class="op">=</span> <span class="st">'mean_max'</span>,</span>
<span>    normalization_param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    stdev_weight_method <span class="op">=</span> <span class="st">'equal'</span>,</span>
<span>    stdev_weight_param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    regularization_method <span class="op">=</span> <span class="st">'none'</span>,</span>
<span>    dependent_arg_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    post_process_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    extra_penalty_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    verbose_startup <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-base-model-definition">base_model_definition<a class="anchor" aria-label="anchor" href="#arg-base-model-definition"></a></dt>
<dd><p>A list meeting the requirements for BioCro
    <code><a href="https://rdrr.io/pkg/BioCro/man/crop_model_definitions.html" class="external-link">crop_model_definitions</a></code>.</p></dd>


  <dt id="arg-data-driver-pairs">data_driver_pairs<a class="anchor" aria-label="anchor" href="#arg-data-driver-pairs"></a></dt>
<dd><p>A list of named elements, where each element is a "data-driver pair." A
    data-driver pair is a list with three required elements: <code>data</code>,
    <code>drivers</code>, and <code>weight</code>. Optionally, it may also have a
    <code>data_stdev</code> element.</p>
<p>The <code>data</code> element must be a data frame with one column named
    <code>time</code>, whose values follow BioCro's definition of
    <code><a href="https://rdrr.io/pkg/BioCro/man/time_variable.html" class="external-link">time</a></code>; the other columns should represent observed
    values of model outputs. Any <code>NA</code> values in <code>data</code> will
    be ignored when calculating the error metric, but all non-<code>NA</code> values
    of all columns (except <code>time</code>) will be compared to the model output.</p>
<p>The <code>drivers</code> element must be a data frame that can be passed to
    <code><a href="https://rdrr.io/pkg/BioCro/man/run_biocro.html" class="external-link">run_biocro</a></code> as its <code>drivers</code> input argument.</p>
<p>The <code>weight</code> element must be a single numeric value indicating a weight
    to be used when calculating the error metric.</p>
<p>The optional <code>data_stdev</code> element must be a data frame with the same
    column names as <code>data</code>, and the same time values; its other entries
    should represent the standard deviation associated with each entry in
    <code>data</code>. If <code>data_stdev</code> is not supplied, all standard deviations
    will be set to 1.</p></dd>


  <dt id="arg-independent-args">independent_args<a class="anchor" aria-label="anchor" href="#arg-independent-args"></a></dt>
<dd><p>A list of named numeric values. The names will determine the independent
    arguments to be varied during their optimization, and the values specify
    "initial" or "test" values of each argument that will be used internally to
    check that the objective function is properly defined and can be evaluated.</p></dd>


  <dt id="arg-quantity-weights">quantity_weights<a class="anchor" aria-label="anchor" href="#arg-quantity-weights"></a></dt>
<dd><p>A list of named numeric values, where the name of each element is one of the
    model outputs to be compared against the observed data, and the value is the
    weight for that output. Each weight can be a single number, or a pair of
    numbers. When the weight is a pair, the first number is the weight that will
    be used for underestimates (when the modeled value is smaller than the
    observed value), and the second is the weight for overestimates.</p></dd>


  <dt id="arg-data-definitions">data_definitions<a class="anchor" aria-label="anchor" href="#arg-data-definitions"></a></dt>
<dd><p>A list of named string values, where the name of each element is one of the
    data columns in the <code>data_driver_pairs</code> and the value is that column's
    corresponding name in the model output. For all other data columns in the
    <code>data_driver_pairs</code>, it is assumed that the data column name matches a
    column in the model output.</p></dd>


  <dt id="arg-normalization-method">normalization_method<a class="anchor" aria-label="anchor" href="#arg-normalization-method"></a></dt>
<dd><p>A string indicating the normalization method to be used when calculating the
    error metric; see below for more details.</p></dd>


  <dt id="arg-normalization-param">normalization_param<a class="anchor" aria-label="anchor" href="#arg-normalization-param"></a></dt>
<dd><p>An (optional) parameter value used by some normalization methods. When
    <code>normalization_param</code> is <code>NULL</code>, a default value will be used,
    which depends on the particular normalization method. Otherwise, the
    user-specified value will be used. See details below.</p></dd>


  <dt id="arg-stdev-weight-method">stdev_weight_method<a class="anchor" aria-label="anchor" href="#arg-stdev-weight-method"></a></dt>
<dd><p>A string indicating the method to be used when calculating the
    variance-based weights used in the error metric; see below for more details.</p></dd>


  <dt id="arg-stdev-weight-param">stdev_weight_param<a class="anchor" aria-label="anchor" href="#arg-stdev-weight-param"></a></dt>
<dd><p>An (optional) parameter value used by some normalization methods. When
    <code>stdev_weight_param</code> is <code>NULL</code>, a default value will be used,
    which depends on the particular normalization method. Otherwise, the
    user-specified value will be used. See details below.</p></dd>


  <dt id="arg-regularization-method">regularization_method<a class="anchor" aria-label="anchor" href="#arg-regularization-method"></a></dt>
<dd><p>A string indicating the regularization method to be used when calculating
    the regularization penalty term; see below for more details.</p></dd>


  <dt id="arg-dependent-arg-function">dependent_arg_function<a class="anchor" aria-label="anchor" href="#arg-dependent-arg-function"></a></dt>
<dd><p>A function whose input argument is a named list of independent argument
    values, and which returns a named list of dependent argument values. If the
    <code>dependent_arg_function</code> is <code>NULL</code>, no dependent argument values
    will be calculated.</p></dd>


  <dt id="arg-post-process-function">post_process_function<a class="anchor" aria-label="anchor" href="#arg-post-process-function"></a></dt>
<dd><p>A function whose input argument is a data frame representing the output from
    <code><a href="https://rdrr.io/pkg/BioCro/man/run_biocro.html" class="external-link">run_biocro</a></code>, and which returns a data frame, typically
    based on the input but with one or more new columns. If the
    <code>post_process_function</code> is <code>NULL</code>, no post-processing will be
    applied to the raw simulation output.</p></dd>


  <dt id="arg-extra-penalty-function">extra_penalty_function<a class="anchor" aria-label="anchor" href="#arg-extra-penalty-function"></a></dt>
<dd><p>A function whose input argument is a data frame representing the output from
    <code><a href="https://rdrr.io/pkg/BioCro/man/run_biocro.html" class="external-link">run_biocro</a></code>, and which returns a numeric penalty to be
    added to the least-squares term when calculating the error metric. If the
    <code>extra_penalty_function</code> is <code>NULL</code>, no extra penalties will be
    added.</p></dd>


  <dt id="arg-verbose-startup">verbose_startup<a class="anchor" aria-label="anchor" href="#arg-verbose-startup"></a></dt>
<dd><p>A logical (<code>TRUE</code> or <code>FALSE</code>) value indicating whether to print
    additional information to the R terminal when creating the objective
    function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Overview</strong></p>
<p>When parameterizing a BioCro model, the general idea is to vary a subset of
  the model's parameters to achieve the best agreement with a set of observed
  data. The degree of agreement is expressed as an "error metric," which
  includes terms derived from the agreement between the modeled and observed
  values, as well as (optional) penalty terms. A function that calculates an
  error metric when given a set of parameter values is called an "objective
  function." Defining an objective function suitable for BioCro parameterization
  can be complicated, but the <code>objective_function</code> function helps to
  simplify the process of creating such a function. It is designed to
  accommodate the following scenarios, which often occur in the context of
  BioCro model parameterization:</p>
<p></p><ul><li><p><strong>Multi-year or multi-location data:</strong> Often the model needs to
          be run several times with different drivers corresponding to multiple
          years or locations, and then the results from each individual
          simulation must be compared to associated sets of observed data. Here,
          this is handled through the <code>data_driver_pairs</code>, which allows the
          user to specify which drivers and data sets should be compared to each
          other.</p></li>
<li><p><strong>Complicated normalization:</strong> Care must be taken to ensure that
          certain years or output variables are not over-valued in the error
          metric; for example, one year may have more observations of leaf mass
          than another year, or the stem mass may be much larger than the leaf
          mass. Here, this is handled through pre-set normalization approaches,
          which can be specified through the <code>normalization_method</code> input.
          See below for more information.</p></li>
<li><p><strong>Extra penalties:</strong> Sometimes an optimizer chooses parameters
          that produce close agreement with the observed data, but are
          nevertheless not biologically resonable. For example, it may produce
          a sharp peak at a high leaf mass in between two measured points, when
          in reality, leaf mass should be nearly constant between them. In this
          case, it may be necessarily to add an extra penalty to the objective
          function that prevents the optimizer from choosing such values. Here,
          this is handled through the <code>extra_penalty_function</code> input.</p></li>
<li><p><strong>Flexible weights:</strong> Often a user would like to specify a weight
          for each variable being considered in the error metric, either to
          represent an uncertainty or to emphasize agreement with one output
          at the expense of another. For example, the seed mass may need a high
          weight to prioritize accurate yield predictions. Further, these
          weights may need to differ for underestimates as compared to
          overestimates; for example, measured root mass is often lower than the
          true root mass, so a user may wish to penalize underestimates of root
          mass more severely than overestimates. Here, these situations are
          handled through the <code>quantity_weights</code> and
          <code>stdev_weight_method</code> inputs.</p></li>
<li><p><strong>Dependent parameters:</strong> Sometimes one model parameter must be
          determined from one or more other parameters; for example, a user may
          wish to require that the leaf and stem maintenance respiration
          coefficients are identical. Here, this is handled through the
          <code>dependent_arg_function</code>, which allows the user to specify how
          the values of such "dependent" parameters should be determined from
          the values of the "independent" parameters.</p></li>
<li><p><strong>Name mismatches:</strong> Often a particular variable has different
          names in the data set and simulation output. Here, this is handled
          through the <code>data_definitions</code>, which allows the user to specify
          which columns in the model output should be compared to particular
          columns in the observed data.</p></li>
<li><p><strong>Incomplete outputs:</strong> Sometimes a model may not produce outputs
          that are directly comparable to the observed values; for example, a
          model may calculate seed and shell mass, while a data set includes pod
          mass, which is the sum of seed and shell. Here, this is handled by an
          optional <code>post_process_function</code>, which allows users to specify
          additional operations to perform on the model output; in this example,
          it would be used to calculate the pod mass so it can be compared to
          the observations.</p></li>
</ul><p><strong>Error metric calculations</strong></p>
<p>As mentioned above, the overall error metric \(E\) is calculated as</p>
<p>$$E = E_{agreement} + P_{user} + P_{regularization},$$
  where \(E_{agreement}\) is determined by the agreement between the model and
  observations, \(P_{user}\) is an optional user-defined penalty, and
  \(P_{regularization}\) is an optional regularization penalty. These terms
  are explained in more detail below:</p>
<p></p><ul><li><p><strong>Agreement term:</strong> The agreement term \(E_{agreement}\) is
          calculated using a least-squares approach. In other words,</p>
<p>$$E_{agreement} = \sum_i \left(Y_{obs}^i - Y_{mod}^i \right)^2%
          \cdot \frac{w_i^{quantity} w_i^{data} w_i^{stdev}}{N_i},$$
          where the sum runs over all \(n\) observations; \(Y_{obs}^i\) and
          \(Y_{mod}^i\) are observed and modeled values of variable \(Y_i\);
          \(w_i^{quantity}\), \(w_i^{data}\), and \(w_i^{stdev}\) are
          weight factors that depend on the name of \(Y_i\), the data set that
          includes the \(i^{th}\) observation, and the standard deviation
          associated with \(Y_{obs}^i\), respectively; and \(N_i\) is a
          normalization factor.</p>
<p>Each value of \(Y_{obs}^i\) is specified at a particular time
          \(t_i\). The corresponding modeled value, \(Y_{mod}^i\), is found
          by retrieving the value of the \(Y_i\) variable at the closest time
          to \(t_i\) that is included in the model output. It is assumed that
          the model always outputs the same sequence of time values each time it
          is run with a particular set of drivers, regardless of the input
          argument values.</p>
<p>The quantity-based weight factors \(w_i^{quantity}\) are directly
          specified by the user via the <code>quantity_weights</code> input. For
          example, if <code>quantity_weights</code> has an element named <code>Leaf</code>
          that is equal to 0.5, then \(w_i\) will be equal to 0.5 whenever
          \(Y_i\) represents a leaf mass value, regardless of which set of
          drivers or time point corresponds to \(Y_i\). The weights can also
          be supplied as \((w_{under}, w_{over})\) pairs instead of single
          values; in this case, the value of \(w_i\) depends on whether the
          model makes an underprediction or an overprediction:
          \(w_i = w_{under}\) when \(Y_{mod}^i &lt; Y_{obs}^i\) and
          \(w_i = w_{over}\) otherwise.</p>
<p>The data-set-based weight factors \(w_i^{data}\) are directly
          specified by the user via the <code>weight</code> element of each
          data-driver pair. For example, if the second element of
          <code>data_driver_pairs</code> has a <code>weight</code> of 2.0, then
          \(w_i^{data}\) will be equal to 2.0 for all observations from the
          corresponding data set.</p>
<p>The standard-deviation-based weight factors \(w_i^{stdev}\) are
          determined by the choice of <code>stdev_weight_method</code>; the available
          methods are discussed below.</p>
<p>The normalization factors \(N_i\) are determined by the choice of
          <code>normalization_method</code>; the available methods are discussed
          below.</p>
<p>There are a few special cases where \(E_{agreement}\) is set to a
          very high value (<code>BioCroValidation:::FAILURE_VALUE</code>). This is
          done when a simulation fails to run, when the \(E_{agreement}\) term
          would otherwise evaluate to <code>NA</code>, or when the \(E_{agreement}\)
          term would otherwise evaluate to an infinite value.</p></li>
<li><p><strong>User-defined penalty term:</strong> The user-defined penalty term
          \(P_{user}\) is calculated by applying a function \(f_{user}\) to
          the full simulation output from each set of drivers. In other words,</p>
<p>$$P_{user} = \sum_k f_{user} \left( M_k \right),$$
          where the sum runs over all \(k\) sets of drivers and \(M_k\) is
          the model output when it is run with the \(k^{th}\) set of drivers.</p>
<p>The function \(f_{user}\) must accept a single data frame as an
          input and return a single numeric value as its output, but has no
          other requirements. It is specified via the
          <code>extra_penalty_function</code> argument. When
          <code>extra_penalty_function</code> is <code>NULL</code>, \(P_{user}\) is zero.</p></li>
<li><p><strong>Regularization penalty term:</strong> The regularization penalty term
          \(P_{regularization}\) is calculated from the values of the
          arguments being varied during the optimization by applying a function
          \(R\). In other words,</p>
<p>$$P_{regularization} = R \left( X \right),$$
          where \(X\) represents the model argument values.</p>
<p>The function \(R\) is determined by the choice of
          <code>regularization_method</code>; the available methods are discussed
          below.</p></li>
</ul><p><strong>Standard-deviation-based weight methods</strong></p>
<p>The following methods are available for determining weight factors from values
  of the standard deviation (\(\sigma\)), which can be (optionally) supplied
  via the <code>data_stdev</code> elements of the <code>data_driver_pairs</code>:</p>
<p></p><ul><li><p><code>'equal'</code>: For this method, \(w_i^{stdev}\) is always set to
          1. In other words, all variances are treated as being equal,
          regardless of any user-supplied values. This is usually the best
          choice when values of \(\sigma\) are unavailable or cannot be
          estimated.</p></li>
<li><p><code>'logarithm'</code>: For this method, \(w_i^{stdev}\) is calculated
          as</p>
<p>$$w_i^{stdev} =%
          ln \left( \frac{1}{\sigma_i + \epsilon} \right),$$
          where \(ln\) denotes a logarithm with base \(e\) and
          \(\epsilon\) is a small number included to prevent numerical errors
          that would otherwise occur when \(\sigma = 0\). This method was
          used in the original Soybean-BioCro paper.</p>
<p>The value of \(\epsilon\) is specified by the
          <code>stdev_weight_param</code> input argument, which defaults to
          <code>1e-5</code> when <code>stdev_weight_param</code> is <code>NULL</code> when using
          this method. With the default value of \(\epsilon\),
          \(w_i^{stdev} \approx 11.512\) when \(\sigma = 0\).</p>
<p>Note: this method should be used with caution, because
          \(w_i^{stdev}\) is zero for \(\sigma_i = 1 - \epsilon\), and it
          becomes negative for larger values of \(\sigma_i\).</p></li>
<li><p><code>'inverse'</code>: For this method, \(w_i^{stdev}\) is calculated as</p>
<p>$$w_i^{stdev} = \frac{1}{\sigma_i^2 + \epsilon},$$
          where \(\epsilon\) is a small number included to prevent numerical
          errors that would otherwise occur when \(\sigma_i = 0\).</p>
<p>The value of \(\epsilon\) is specified by the
          <code>stdev_weight_param</code> input argument, which defaults to
          <code>1e-1</code> when <code>stdev_weight_param</code> is <code>NULL</code> when using
          this method. With the default value of \(\epsilon\),
          \(w_i^{stdev} = 10\) when \(\sigma_i = 0\).</p></li>
</ul><p>If any values of \(w_i^{stdev}\) are undefined, negative, or infinite, an
  error message will occur (see the "Input checks" section below).</p>
<p><strong>Normalization methods</strong></p>
<p>The following normalization methods are available:</p>
<p></p><ul><li><p><code>'equal'</code>: For this method, \(N_i\) is always set to 1. In
          other words, no normalization is performed.</p></li>
<li><p><code>'mean'</code>: For this method, when \(Y_i\) is named <code>vtype</code>
          and the observation is from a set called <code>vdata</code>, then</p>
<p>$$N_i = n_{vtype}^{vdata} \cdot n_{data},$$
          where \(n_{vtype}^{vdata}\) is the number of observations of type
          <code>vtype</code> that are included in <code>vdata</code> and \(n_{data}\) is
          the total number of data-driver pairs. In this case, the error term
          \(E_{agreement}\) becomes a mean error across the full set of
          drivers, hence the name for this method. This approach avoids
          over-representing drivers with larger numbers of associated
          observations when determining \(E_{agreement}\). It also preserves
          the overall magnitude of \(E_{agreement}\) when data-driver pairs
          are added.</p></li>
<li><p><code>'max'</code>: For this method, when \(Y_i\) is named <code>vtype</code>
          and the observation is from a set called <code>vdata</code>, then</p>
<p>$$N_i = \left( max_{vtype}^{vdata} \right)^2,$$
          where \(max_{vtype}^{vdata}\) is the maximum observed value of
          <code>vtype</code> across <code>vdata</code>. In this case, the observed and
          modeled values that appear in the equation for \(E_{agreement}\) are
          essentially normalized by their maximum value, hence the name for this
          method. This approach avoids over-representing variable types with
          larger magnitude when determining \(E_{agreement}\).</p></li>
<li><p><code>'obs'</code>: For this method,</p>
<p>$$N_i = \left( Y_{obs}^i \right)^2 + \epsilon,$$
          where \(\epsilon\) is a small number included to prevent numerical
          errors that would otherwise occur when \(Y_{obs}^i = 0\). In this
          case, the equation for \(E_{agreement}\) essentially uses relative
          differences rather than absolute differences, which is achieved by
          normalizing by the observed values, hence the name. This approach
          avoids over-representing time points where a particular quantity takes
          its largest values when determining \(E_{agreement}\).</p>
<p>The value of \(\epsilon\) is specified by the
          <code>normalization_param</code> input argument, which defaults to
          <code>1e-1</code> when <code>normalization_param</code> is <code>NULL</code> when using
          this method. With the default value of \(\epsilon\), \(N_i = 10\)
          when \(Y_{obs}^i = 0\).</p></li>
<li><p><code>'mean_max'</code>: For this method, the "mean" and "max" methods are
          combined so that</p>
<p>$$N_i = n_{vtype}^{vdrivers}%
          \cdot n_{data} \cdot \left( max_{vtype}^{vdata} \right)^2.$$
          This approach avoids over-representing drivers with larger numbers of
          associated observations, and variable types with larger magnitudes.
          This method is used for parameterizing Soybean-BioCro.</p></li>
<li><p><code>'mean_obs'</code>: For this method, the "mean" and "obs" methods are
          combined so that</p>
<p>$$N_i = n_{vtype}^{vdrivers} \cdot n_{data}%
          \cdot \left( \left( Y_{obs}^i \right)^2 + \epsilon \right)^2.$$
          This approach avoids over-representing drivers with larger numbers of
          associated observations, and time points with larger observed values.</p>
<p>The value of \(\epsilon\) is specified by the
          <code>normalization_param</code> input argument, which defaults to
          <code>1e-1</code> when <code>normalization_param</code> is <code>NULL</code> when using
          this method. With the default value of \(\epsilon\),
          \(N_i = 10 \cdot n_{vtype}^{vdrivers} \cdot n_{data}\) when
          \(Y_{obs}^i = 0\).</p></li>
</ul><p>In most situations, it is recommended to use either <code>'mean_max'</code> or
  <code>'mean_obs'</code> depending on user preference or performance.</p>
<p><strong>Regularization methods</strong></p>
<p>The following regularization methods are available:</p>
<p></p><ul><li><p><code>'none'</code>: For this method, \(P_{regularization}\) is always set
          to 0. In other words, no regularization is performed.</p></li>
<li><p><code>'L1'</code> or <code>'lasso'</code>: For this method,
          \(P_{regularization}\) is given by the sum of the absolute values of
          each independent argument, multiplied by a "regularization parameter"
          \(\lambda\) that sets the overall weight of the penalty:</p>
<p>$$P_{regularization} = \lambda \sum_j | X_j |,$$
          where the sum runs over all \(j\) independent arguments, and
          \(X_j\) is the value of the \(j^{th}\) argument. See the "Value"
          section below for details of how to specify \(\lambda\).</p></li>
<li><p><code>'L2'</code> or <code>'ridge'</code>: For this method,
          \(P_{regularization}\) is given by the sum of the squared values of
          each independent argument, multiplied by a "regularization parameter"
          \(\lambda\) that sets the overall weight of the penalty:</p>
<p>$$P_{regularization} = \lambda \sum_j X_j^2,$$
          where the sum runs over all \(j\) independent arguments, and
          \(X_j\) is the value of the \(j^{th}\) argument. See the "Value"
          section below for details of how to specify \(\lambda\).</p></li>
</ul><p><strong>Input checks</strong></p>
<p>Several checks are made to ensure that the objective function is properly
  defined. These checks include, but are not limited to, the following:</p>
<p></p><ul><li><p>Ensuring that each set of drivers in <code>data_driver_pairs</code> defines
          a valid dynamical system along with the <code>base_model_definition</code>.
          This is accomplished using
          <code><a href="https://rdrr.io/pkg/BioCro/man/dynamical_system.html" class="external-link">validate_dynamical_system_inputs</a></code>.</p></li>
<li><p>Ensuring that the model output corresponding to each set of drivers
          spans the times at which the observations were made.</p></li>
<li><p>Ensuring that each variable type in the data elements of
          <code>data_driver_pairs</code> matches a corresponding column in the model
          output, when accounting for the <code>data_definitions</code> and
          <code>post_process_function</code>.</p></li>
<li><p>Ensuring that each independent and dependent argument name is either
          a parameter or initial value of the model. Internally, argument names
          are passed to <code><a href="https://rdrr.io/pkg/BioCro/man/partial_application.html" class="external-link">partial_run_biocro</a></code> via its
          <code>arg_names</code> input. Note that argument names passed to
          <code>partial_run_biocro</code> can technically include drivers, but it is
          unlikely that the value of a driver would be varied during an
          optimization, so the argument names are not allowed to include
          columns in the drivers.</p></li>
<li><p>Ensuring that the optional <code>dependent_arg_function</code>,
          <code>post_process_function</code>, and <code>extra_penalty_function</code>
          functions can be run without causing errors.</p></li>
<li><p>Ensuring that certain values are finite (such as \(Y_{obs}\),
          \(\sigma_i\), \(w_i^{stdev}\), and \(N_i\)), and that certain
          values are not negative (such as \(\sigma_i\), \(w_i^{stdev}\),
          and \(N_i\)).</p></li>
</ul><p>If any issues are detected, an informative error message will be sent. Note
  that several of these checks require running the model with each set of
  drivers. For these checks, the argument values specified by
  <code>independent_args</code> will be used, so they should be valid or otherwise
  reasonable values.</p>
<p>If an error message occurs when <code>verbose_startup</code> was set to
  <code>FALSE</code>, it is recommended to call this function again with
  <code>verbose_startup</code> set to <code>TRUE</code>, since the additional output can be
  helpful for troubleshooting.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A function <code>obj_fun</code> with signature
  <code>obj_fun(x, lambda = 0, return_terms = FALSE, debug_mode = FALSE)</code>.</p>
<p>Here, <code>x</code> is a numeric vector of values of the independent arguments (in
  the same order as in <code>independent_arg_names</code>), and <code>lambda</code> is the
  value of the regularization parameter.</p>
<p>The <code>return_terms</code> argument determines the return value of
  <code>obj_fun</code>. When <code>return_terms</code> is <code>FALSE</code>, <code>obj_fun</code>
  returns values of the error metric \(E\). When <code>return_terms</code> is
  <code>TRUE</code>, <code>obj_fun</code> returns a list including each individual term of
  the total error metric.</p>
<p>During optimization, <code>return_terms</code> should always be <code>FALSE</code>.
  Setting it to <code>TRUE</code> can be useful for troubleshooting, or for
  diagnostics such as checking the quality of fit for each of the data-driver
  pairs.</p>
<p>The <code>debug_mode</code> argument determines whether <code>obj_fun</code> is running in
  debug mode. In debug mode, each time <code>obj_fun</code> is called, it will print
  the values of <code>x</code> and the error metric to the R terminal. This can be
  useful when troubleshooting a problem with an optimization, since it provides
  a record of any problematic parameter combinations. When setting
  <code>debug_mode</code> to <code>TRUE</code>, also consider using <code><a href="https://rdrr.io/r/base/sink.html" class="external-link">sink</a></code>
  to write the outputs to a file instead of the R terminal. In that case, there
  will still be a record even if R crashes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example: Create an objective function that enables optimization of the</span></span></span>
<span class="r-in"><span><span class="co"># `alphaLeaf`, `betaLeaf`, and `alphaStem` parameters of the Soybean-BioCro</span></span></span>
<span class="r-in"><span><span class="co"># model. Additional details are provided below. Important note: This example is</span></span></span>
<span class="r-in"><span><span class="co"># designed to highlight key features of `objective_function`, and is not</span></span></span>
<span class="r-in"><span><span class="co"># necessarily realistic.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/biocro/biocro" class="external-link">BioCro</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># We will use Soybean-BioCro as the base model definition, but we will change</span></span></span>
<span class="r-in"><span>  <span class="co"># the ODE solver to use the Euler method so the model runs faster.</span></span></span>
<span class="r-in"><span>  <span class="va">base_model_definition</span>            <span class="op">&lt;-</span> <span class="fu">BioCro</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BioCro/man/soybean.html" class="external-link">soybean</a></span></span></span>
<span class="r-in"><span>  <span class="va">base_model_definition</span><span class="op">$</span><span class="va">ode_solver</span> <span class="op">&lt;-</span> <span class="fu">BioCro</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BioCro/man/default_ode_solvers.html" class="external-link">default_ode_solvers</a></span><span class="op">[[</span><span class="st">'homemade_euler'</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We will use the `soyface_biomass` data set (included with the</span></span></span>
<span class="r-in"><span>  <span class="co"># `BioCroValidation` package) for the observed values; this set includes</span></span></span>
<span class="r-in"><span>  <span class="co"># observations of leaf, stem, and pod biomass from two years, which are stored</span></span></span>
<span class="r-in"><span>  <span class="co"># in two data tables; it also includes the standard deviations of the measured</span></span></span>
<span class="r-in"><span>  <span class="co"># biomasses, which are included in two separate tables. However, these data</span></span></span>
<span class="r-in"><span>  <span class="co"># tables each have a `DOY` column rather than a `time` column, so we need to</span></span></span>
<span class="r-in"><span>  <span class="co"># alter them. The tables also include other columns we do not wish to use in</span></span></span>
<span class="r-in"><span>  <span class="co"># this example. So, we will define a short helper function that can be used to</span></span></span>
<span class="r-in"><span>  <span class="co"># pre-process each table.</span></span></span>
<span class="r-in"><span>  <span class="va">process_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="co"># Define new `time` column</span></span></span>
<span class="r-in"><span>      <span class="va">time</span> <span class="op">=</span> <span class="op">(</span><span class="va">DOY</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">24.0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>      <span class="co"># Remove unneeded columns</span></span></span>
<span class="r-in"><span>      <span class="va">DOY</span>                 <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>      <span class="va">Seed_Mg_per_ha</span>      <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>      <span class="va">Litter_Mg_per_ha</span>    <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>      <span class="va">CumLitter_Mg_per_ha</span> <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>    <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The data-driver pairs can now be created by associating each data set with</span></span></span>
<span class="r-in"><span>  <span class="co"># its corresponding weather data. Here we will weight the 2005 data twice as</span></span></span>
<span class="r-in"><span>  <span class="co"># heavily as the 2002 data.</span></span></span>
<span class="r-in"><span>  <span class="va">data_driver_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ambient_2002 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      data       <span class="op">=</span> <span class="fu">process_table</span><span class="op">(</span><span class="va">soyface_biomass</span><span class="op">[[</span><span class="st">'ambient_2002'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      data_stdev <span class="op">=</span> <span class="fu">process_table</span><span class="op">(</span><span class="va">soyface_biomass</span><span class="op">[[</span><span class="st">'ambient_2002_std'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      drivers    <span class="op">=</span> <span class="fu">BioCro</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BioCro/man/cmi_soybean_weather_data.html" class="external-link">soybean_weather</a></span><span class="op">[[</span><span class="st">'2002'</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      weight     <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    ambient_2005 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      data       <span class="op">=</span> <span class="fu">process_table</span><span class="op">(</span><span class="va">soyface_biomass</span><span class="op">[[</span><span class="st">'ambient_2005'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      data_stdev <span class="op">=</span> <span class="fu">process_table</span><span class="op">(</span><span class="va">soyface_biomass</span><span class="op">[[</span><span class="st">'ambient_2005_std'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      drivers    <span class="op">=</span> <span class="fu">BioCro</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BioCro/man/cmi_soybean_weather_data.html" class="external-link">soybean_weather</a></span><span class="op">[[</span><span class="st">'2005'</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      weight     <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># In the data, the leaf biomass is in the `Leaf_Mg_per_ha` column, but in the</span></span></span>
<span class="r-in"><span>  <span class="co"># simulation output, it is in the `Leaf` column. Similar naming differences</span></span></span>
<span class="r-in"><span>  <span class="co"># occur for the stem and pod mass. To address this, we can provide a data</span></span></span>
<span class="r-in"><span>  <span class="co"># definition list.</span></span></span>
<span class="r-in"><span>  <span class="va">data_definitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Leaf_Mg_per_ha <span class="op">=</span> <span class="st">'Leaf'</span>,</span></span>
<span class="r-in"><span>    Stem_Mg_per_ha <span class="op">=</span> <span class="st">'Stem'</span>,</span></span>
<span class="r-in"><span>    Rep_Mg_per_ha <span class="op">=</span> <span class="st">'Pod'</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># The data contains values of pod mass, but the model does not calculate pod</span></span></span>
<span class="r-in"><span>  <span class="co"># mass; instead, it returns separate values of `Grain` (seed) and `Shell`</span></span></span>
<span class="r-in"><span>  <span class="co"># mass, two components which form the pod together. To address this, we can</span></span></span>
<span class="r-in"><span>  <span class="co"># provide a post-processing function to calculate the pod mass.</span></span></span>
<span class="r-in"><span>  <span class="va">post_process_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim_res</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">sim_res</span>, <span class="op">{</span><span class="va">Pod</span> <span class="op">=</span> <span class="va">Grain</span> <span class="op">+</span> <span class="va">Shell</span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Here we wish to independently vary the `alphaLeaf` and `betaLeaf`</span></span></span>
<span class="r-in"><span>  <span class="co"># parameters. We also wish to vary `alphaStem`, but require that its value is</span></span></span>
<span class="r-in"><span>  <span class="co"># always equal to `alphaLeaf`. To do this, we can specify independent</span></span></span>
<span class="r-in"><span>  <span class="co"># arguments, and a function for determining dependent argument values. We will</span></span></span>
<span class="r-in"><span>  <span class="co"># choose "test" values of the independent arguments as their values in the</span></span></span>
<span class="r-in"><span>  <span class="co"># original Soybean-BioCro model.</span></span></span>
<span class="r-in"><span>  <span class="va">independent_args</span> <span class="op">&lt;-</span> <span class="fu">BioCro</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BioCro/man/soybean.html" class="external-link">soybean</a></span><span class="op">[[</span><span class="st">'parameters'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alphaLeaf'</span>, <span class="st">'betaLeaf'</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">dependent_arg_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ind_args</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alphaStem <span class="op">=</span> <span class="va">ind_args</span><span class="op">[[</span><span class="st">'alphaLeaf'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># When determining the error metric value, we wish to weight the pod highest</span></span></span>
<span class="r-in"><span>  <span class="co"># to ensure a close fit to the observed pod masses. We also wish to decrease</span></span></span>
<span class="r-in"><span>  <span class="co"># the penalty for overestimates of the stem mass, since we believe our</span></span></span>
<span class="r-in"><span>  <span class="co"># observations to be underestimates.</span></span></span>
<span class="r-in"><span>  <span class="va">quantity_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Leaf <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    Stem <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Pod <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We want to prevent the optimizer from choosing parameters that produce</span></span></span>
<span class="r-in"><span>  <span class="co"># unreasonably high leaf mass</span></span></span>
<span class="r-in"><span>  <span class="va">extra_penalty_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim_res</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">max_leaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sim_res</span><span class="op">[[</span><span class="st">'Leaf'</span><span class="op">]</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">max_leaf</span><span class="op">)</span> <span class="op">||</span> <span class="va">max_leaf</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fl">1e5</span> <span class="co"># Add a steep penalty</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fl">0</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Now we can finally create the objective function</span></span></span>
<span class="r-in"><span>  <span class="va">obj_fun</span> <span class="op">&lt;-</span> <span class="fu">objective_function</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">base_model_definition</span>,</span></span>
<span class="r-in"><span>    <span class="va">data_driver_pairs</span>,</span></span>
<span class="r-in"><span>    <span class="va">independent_args</span>,</span></span>
<span class="r-in"><span>    <span class="va">quantity_weights</span>,</span></span>
<span class="r-in"><span>    data_definitions <span class="op">=</span> <span class="va">data_definitions</span>,</span></span>
<span class="r-in"><span>    stdev_weight_method <span class="op">=</span> <span class="st">'logarithm'</span>,</span></span>
<span class="r-in"><span>    dependent_arg_function <span class="op">=</span> <span class="va">dependent_arg_function</span>,</span></span>
<span class="r-in"><span>    post_process_function <span class="op">=</span> <span class="va">post_process_function</span>,</span></span>
<span class="r-in"><span>    extra_penalty_function <span class="op">=</span> <span class="va">extra_penalty_function</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># This function could now be passed to an optimizer; here we will simply</span></span></span>
<span class="r-in"><span>  <span class="co"># evaluate it for two sets of parameter values.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Try doubling each parameter value; in this case, the value of the</span></span></span>
<span class="r-in"><span>  <span class="co"># objective function increases, indicating a lower degree of agreement between</span></span></span>
<span class="r-in"><span>  <span class="co"># the model and the observed data. Here we will call `obj_fun` in debug mode,</span></span></span>
<span class="r-in"><span>  <span class="co"># which will automatically print the value of the error metric.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'\nError metric calculated by doubling the initial argument values:\n'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">error_metric</span> <span class="op">&lt;-</span> <span class="fu">obj_fun</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">independent_args</span><span class="op">)</span>, debug_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can also see the values of each term that makes up the error metric;</span></span></span>
<span class="r-in"><span>  <span class="co"># again, we will call `obj_fun` in debug mode for automatic printing.</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'\nError metric terms calculated by doubling the initial argument values:\n'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">error_terms</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">obj_fun</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">independent_args</span><span class="op">)</span>, return_terms <span class="op">=</span> <span class="cn">TRUE</span>, debug_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: BioCro</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The independent arguments and their initial values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ alphaLeaf: num 23.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ betaLeaf : num -18.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The dependent arguments and their initial values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ alphaStem: num 23.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full data definitions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Leaf_Mg_per_ha: chr "Leaf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Stem_Mg_per_ha: chr "Stem"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Rep_Mg_per_ha : chr "Pod"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The user-supplied data in long form:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ambient_2002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time quantity_name quantity_value quantity_stdev time_index expected_npts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  4272          Leaf   0.1802843394   0.0408155501        649          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4512          Leaf   0.5544619422   0.1638632739        889          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  4848          Leaf   1.3265529308   0.1337744335       1225          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  5184          Leaf   1.6979440069   0.2283266576       1561          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5520          Leaf   1.8077427820   0.2024754215       1897          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  5880          Leaf   1.5788136482   0.0754751654       2257          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  6192          Leaf   0.9475377733   0.3445500325       2569          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  6888          Leaf   0.0000000000   0.0000000000       3265          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  4272          Stem   0.0852449694   0.0170797372        649          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 4512          Stem   0.4188538932   0.1384490248        889          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 4848          Stem   1.7110673664   0.1837107594       1225          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 5184          Stem   2.8928258965   0.4487440652       1561          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 5520          Stem   3.6859142604   0.4534474707       1897          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 5880          Stem   3.7452607171   0.2753213561       2257          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 6192          Stem   3.6184015745   0.1510453777       2569          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 6888          Stem   2.3057012247   0.1483892609       3265          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 4272           Pod   0.0000000000   0.0000000000        649          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 4512           Pod   0.0000000000   0.0000000000        889          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 4848           Pod   0.0003171479   0.0005493162       1225          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 5184           Pod   0.0793963255   0.0309899985       1561          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 5520           Pod   1.5545713035   0.2184025435       1897          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 5880           Pod   3.9760135605   0.5735488281       2257          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 6192           Pod   6.5446506556   0.7434407011       2569          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 6888           Pod   7.0089676285   0.1418286169       3265          3288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         norm      w_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   52.28694  3.1984472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   52.28694  1.8086619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   52.28694  2.0115255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   52.28694  1.4769342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   52.28694  1.5970874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   52.28694  2.5838191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   52.28694  1.0654869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   52.28694 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  224.43165  4.0692772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 224.43165  1.9771808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 224.43165  1.6943383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 224.43165  0.8012803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 224.43165  0.7908538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 224.43165  1.2897800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 224.43165  1.8901088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 224.43165  1.9078489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 786.01004 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 786.01004 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 786.01004  7.4887956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 786.01004  3.4737681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 786.01004  1.5213696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 786.01004  0.5558948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 786.01004  0.2964528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 786.01004  1.9530654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ambient_2005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    time quantity_name quantity_value quantity_stdev time_index expected_npts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  4104          Leaf     0.22227188     0.03289659        577          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  4440          Leaf     0.84603750     0.14679830        913          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  4776          Leaf     1.18446563     0.33807429       1249          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  5112          Leaf     2.21805938     0.15217591       1585          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  5448          Leaf     2.14744687     0.11907759       1921          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  5784          Leaf     1.51948125     0.51280870       2257          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  6120          Leaf     0.06575625     0.06168624       2593          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  6456          Leaf     0.00000000     0.00000000       2929          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  4104          Stem     0.18880312     0.01431814        577          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 4440          Stem     0.85220625     0.19883006        913          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 4776          Stem     1.61896875     0.60528625       1249          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 5112          Stem     4.04361563     0.55987405       1585          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 5448          Stem     4.47772500     0.30674464       1921          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 5784          Stem     3.89208750     0.37910849       2257          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 6120          Stem     2.89905000     0.22082398       2593          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 6456          Stem     2.17560000     0.24325473       2929          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 4104           Pod     0.00000000     0.00000000        577          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 4440           Pod     0.00000000     0.00000000        913          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 4776           Pod     0.00000000     0.00000000       1249          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 5112           Pod     0.29925000     0.16427520       1585          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 5448           Pod     2.30455312     0.43414807       1921          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 5784           Pod     5.53277813     0.58847698       2257          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 6120           Pod     5.37107813     0.52004438       2593          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 6456           Pod     6.37225313     0.63309086       2929          2952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        norm      w_var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   78.7166  3.4140824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   78.7166  1.9186276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   78.7166  1.0844600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   78.7166  1.8826524</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   78.7166  2.1278960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   78.7166  0.6678329</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   78.7166  2.7855322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   78.7166 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  320.8003  4.2455301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 320.8003  1.6152545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 320.8003  0.5020373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 320.8003  0.5800256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 320.8003  1.1817071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 320.8003  0.9699065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 320.8003  1.5103441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 320.8003  1.4136050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 649.6898 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 649.6898 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 649.6898 11.5129255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 649.6898  1.8061514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 649.6898  0.8343466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 649.6898  0.5302005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 649.6898  0.6538219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 649.6898  0.4571255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The user-supplied quantity weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Leaf: num [1:2] 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Stem: num [1:2] 0.5 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Pod : num [1:2] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The user-supplied data-driver pair weights:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ambient_2002: num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ambient_2005: num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The initial error metric terms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ terms_from_data_driver_pairs:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ambient_2002:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ least_squares_terms:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Leaf: num 0.0454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Pod : num 0.00176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Stem: num 0.0374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ extra_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ambient_2005:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ least_squares_terms:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Leaf: num 0.0477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Pod : num 0.021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Stem: num 0.0354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ extra_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ regularization_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The initial error metric value:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1886707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error metric calculated by doubling the initial argument values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time: 2025-05-23 21:19:54.549076    Independent argument values: 47.779, -36.1702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time: 2025-05-23 21:19:54.974144    Error metric: 1.63915459199451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error metric terms calculated by doubling the initial argument values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time: 2025-05-23 21:19:54.974291    Independent argument values: 47.779, -36.1702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time: 2025-05-23 21:19:55.347211     Error metric terms: List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ terms_from_data_driver_pairs:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ambient_2002:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ least_squares_terms:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Leaf: num 0.141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Pod : num 0.154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Stem: num 0.247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ extra_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ ambient_2005:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ least_squares_terms:List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Leaf: num 0.172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Pod : num 0.179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ Stem: num 0.746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ extra_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ regularization_penalty      : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

